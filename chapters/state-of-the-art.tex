\documentclass[../main.tex]{subfiles}

\begin{document}

\chapter{State of the Art}
The concept of an \textit{exoskeleton} will refer to robotic exoskeletons or powered exoskeletons as defined by \textcite{Gorgey2018}: "Robotic exoskeletons or powered exoskeletons are considered wearable robotic units controlled by computer boards to power a system of motors, pneumatics, levers, or hydraulics to restore locomotion" \parencite[113]{Gorgey2018}.
A typical powered exoskeleton would have a motor or some sort of actuator to produce torque at the joints (e.g. knee joint) to enable or assist the user.

The amount of torque produced for any given motion depends on the control system of the exoskeleton.
Many different methods have been researched and implemented towards the goal of making a good control system that provides exactly the assist that the user wants and/or needs.
The key to that goal is to estimate or predict the joint torque associated with a certain motion performed by the user.

This chapter discusses the state of the art of exoskeleton control systems and joint torque and muscle force prediction models.
Note that the overall focus is on lower extremities.
First, the discussion is aimed towards methods and models that are used today for kinetics of human motion analysis in general research and clinical applications.
This includes discussion about data acquisition, especially \ac{EMG} data, and its relation to the body dynamics, i.e. muscle forces.
Second, the discussion is narrowed towards the methods and models that can be used as control systems in an exoskeleton.
The flexibility for computation and data acquisition is lower in an exoskeleton and thus the number of methods that could be used more limited.
Third, the discussion is focused toward the state of the art of one particular method which consists of joint torque prediction using \ac{ANN} with \ac{EMG} data acquisition. 
This also includes general discussion about the research of different \acp{ANN} that have been used with \ac{EMG} data.

\section{Kinetics of Human Motion: methods, models, and data acquisition}
\label{sec:A-MSModels}
Kinetics of human motion is the study of the forces that cause human motion. 
This includes muscle forces as well as external forces, such as \ac{GRF}.
It is challenging to measure \textit{in vivo} muscle forces and it requires at least a minimally invasive methods or an open surgery, so that a force transducer can be placed on a tendon attached to the muscle \cite{Erdemir2007}. 
Thus, in general clinical application as well as in exoskeletons, measuring muscle forces directly is hardly an option.
However, it is possible with non-invasive methods to measure reaction forces like \ac{GRF}, human motion, and \ac{EMG}.
Several methods have then been developed to estimate joint torques and muscle forces using this data \cite{Erdemir2007}.
For the purpose of this chapter these methods will be split into two groups, namely those who use \ac{EMG} data (\ac{EMG}-based methods) and those who do not use \ac{EMG} data (Non-\ac{EMG}-based methods).
This chapter begins with the models that do not use \ac{EMG} data.
That includes inverse dynamics for joint torque estimations and static and dynamic optimization for muscle force estimation. 
Then it goes into detail about \ac{EMG} and its relation to muscle activity before discussing the models that do use \ac{EMG} data, namely \ac{EMG}-driven models.

\subsection{Non-\ac{EMG}-based Models}
\label{sec:A-NonEMGBasedModels}
\textit{Inverse dynamics} is, as defined by the Dictionary of Sport and Exercise Science and Medicine, "the calculation of forces and moments by using kinematics and data for mass and moment of inertia, effectively using Newton's second law of motion ($f = ma$) in reverse."\footnote{"inverse dynamics." Dictionary of Sport and Exercise Science and Medicine by Churchill Livingstone. 2008. Elsevier Limited 18 Mar. 2019 \url{https://medical-dictionary.thefreedictionary.com/inverse+dynamics}}
In relation to the human body this means the use of kinetics and kinematics, e.g. motion capture, scaled model, and force plate data from a motion lab, to calculate joint torque estimations.
As the method works with the equation of motion, it relies on correct scaling of each body segment, and joints angles and positions relative to the reaction forces \cite{Erdemir2007, Buchanan2004}.
Extensive research has been done on inverse dynamics and it is widely used in clinical applications such as, for example, gait analysis in rehabilitation \cite{Erdemir2007,Buchanan2004,Pizzolato2015}.

OpenSim \cite{Delp2007, Seth2018} is an open-source software offering biomechanical models and simulation tools to, among many other things, model and run inverse dynamic solution on a scaled musculoskeletal model \cite{Buchanan2004, Delp2007, Seth2018, Pizzolato2017}.

The inverse dynamics method alone does not provide any information about muscle activation and muscle forces.
There are several methods that have been implemented to estimate muscle activation and muscle forces \cite{Erdemir2007}.
Perhaps the most notable ones that are not \ac{EMG}-drive are the static and dynamic optimization methods \cite{Erdemir2007, Pizzolato2015, Delp2007}. 

The \textit{static optimization} method uses optimization with an objective function such as, for example, minimizing the sum of muscle forces from all muscles. 
Through iteration the muscle forces, that both fit to the estimated joint torque from the inverse dynamics model and satisfy the objective function, are calculated \cite{Erdemir2007}. 

\textit{Dynamic optimization} is an alternative to static optimization which, in short, uses forward dynamics to find the set of muscle activations that best fit the experimental kinematic data (e.g. with objective to minimize tracking error in kinematics and \ac{GRF}). 
This method does not require inverse dynamics to first estimate joint torques since the constraint is rather the measured motion and \ac{GRF} data.
\textcite{Erdemir2007} point out that this method is beneficial as compared to the static optimization because of its more straightforward inclusion of muscle dynamics within the solution.
Furthermore, it is less vulnerable toward errors in the experimental measurements as the inclusion of the kinematic data is somewhat "weak", i.e. there is a slack on the kinematic data in favor of more intact muscle dynamics.
However, the dynamic optimization method is more computationally heavy when compared to the static optimization method \cite{Erdemir2007}.

There is a limitation to these optimization methods due to variations in muscle synergies.
\textcite{Ivanenko2016} define muscle synergies as representing "coordinated activations of groups of muscles, with specific activation balances or temporal profiles, that might reflect basic biomechanical properties of the musculoskeletal apparatus or statistical regularities in the muscle activation patterns involved in performing a specific motor behavior" \parencite[160]{Ivanenko2016}.
This means that muscles are not necessarily recruited to produce a specific torque at a joint but rather they are recruited as part of a muscle synergy that relates to a specific task, such as taking a step.
As pointed out by \textcite{Pizzolato2015} the optimization method, including static and dynamic optimization, cannot account for variations in muscle activation patterns (i.e. muscle synergies) between tasks and individuals.
For example, if the objective function is to minimize the sum of muscle forces that fit a certain joint moment, it does not account for the fact different muscle synergies can produce the same joint moment. 
Muscle synergies have been shown to be task-specific and vary between individuals and different pathologies \cite{Ivanenko2016, Safavynia2011}.
To account for this drawback, muscle activation need to be measured and accounted for, for example by using \ac{sEMG} and \ac{EMG}-driven models \cite{Pizzolato2015}.

\subsection{Electromyography and Muscle Activity}
\label{sec:A-EMG}
Muscle forces of the skeletal muscles are the forces produced by the human body to move or stabilize the human body. 
The muscle force is generated by muscle contraction which is activated by electrical \ac{AP} travelling through the nerves of the body to and through the muscle fibers. 
A single muscle is comprised of many \acp{MU} which in turn contain many muscle fibers.
Each \ac{MU} is activated by the \ac{AP} from a single motor neuron.
The muscle force produced thus depends, but not exclusively, on the amount of fibers per \ac{MU} and the number of \acp{MU} activating.
Other factors influencing the muscle force include the fiber properties (e.g. cross-sectional area and specific force), the cooperation of different \acp{MU} within the muscle, \ac{AP} frequency, etc.
Furthermore, if looking at the force exerted by the muscle to the skeleton to produce movement, i.e. the \ac{MTU} force, then the properties of the tendon, such as elasticity, need to be considered as well \cite{Pizzolato2015, Enoka2016, Farina2016}. 

\textcite{Raez2006} provide the following definition for EMG signals: "The EMG signal is a biomedical signal that measures electrical currents generated in muscles during its contraction representing neuromuscular activities" \parencite[1]{Raez2006} where biomedical signal refers to an electrical signal from any organ that represents a specific physical variable.
The \ac{EMG} signal also depends on the number of \acp{MU} activated and the \ac{AP} frequency and has been found to correlate with the muscle force.
However, the relation between the two varies from muscle to muscle and furthermore, both relate nonlinearly to the neural drive from the motor neuron.
Consequently, \ac{EMG} does not directly measure muscle forces but rather how activated the \acp{MU} are \cite{Enoka2016, Farina2016}.

There are two common methods of measuring \ac{EMG}, one being the invasive method where a needle electrode is inserted percutaneously to the target muscle, and the second being the surface \ac{EMG} method where electrodes are placed on the skin close to the target muscle. 
Although the invasive method can give more accurate signal, the \ac{sEMG} method is more widely used due to the fact that it is non-invasive and easier to implement. 
The continued discussion here about \ac{EMG}s will be focused on the \ac{sEMG} method.
When using the \ac{sEMG} method the source of the signal and the recording electrodes are separated by biological tissues (e.g. skin, fat, blood vessels).
The signal can still be detected as the \ac{AP} in the muscle fibers generates an electric field in the surrounding tissue with conducting properties.
However, these tissues act as spatial and temporal low-pass filters with resulting deforming effect on the signal.
A common method to partially compensate for the spatial low-pass filtering is to use a pair of electrodes positioned few cm apart.
This method also allows removing the common-mode component (e.g. $50Hz$ from power line interference) \cite{Farina2016}.

Some other artifacts of the \ac{sEMG} signal include, for example end-of-fiber effect, electrode-skin impedance, and crosstalk \cite{Farina2016}.
Due to all these implications and artifacts the signal recorded by the electrodes depends on a number of anatomical, physical, and detection system parameters. The following list are the most important factors as listed by \textcite[p. 41]{Farina2016}:
\begin{quote}
(1) the thickness of the subcutaneous tissue layer,
(2) the depth of the sources within the muscle,
(3) the inclination of the detection system with respect to the muscle fiber orientation,
(4) the length of the fibers,
(5) the location of the electrodes over the muscle,
(6) the spatial filter (electrode montage) used for signal detection, including the inter-electrode distance,
(7) the electrode size and shape, and
(8) crosstalk among nearby muscles.
\end{quote}
Thus, it is easy to see that the \ac{sEMG} can vary highly between individuals as well as between days and measurements of the same individual.

Guidelines have been made by \ac{SENIAM} in effort to make \ac{sEMG} procedures more standardized and comparable and to increase reproducibility of the experiment. 
The \ac{SENIAM} project is a European concerted action towards development of recommendations on sensors, sensor placement, signal processing, and modelling for \ac{sEMG} \cite{Hermens1999, Hermens2000}.
One setback of \ac{sEMG} is that it only possible to measure muscles near the surface.
If the muscle is located behind other muscles, if there is too much tissue between the source of the signal and the electrodes or if the position of the electrodes are closer to another muscle, then the integrity and selectivity of the signal is compromised \cite{Farina2016, Hermens2000}.
The \ac{SENIAM} project provides \ac{sEMG} electrode placement recommendations for 14 muscles on lower extremities, including the hip \cite{Hermens1999}.

The amplitude of \ac{EMG} signal is in the range of $\pm 5$ or $0-10 mV$ but it is random in nature \cite{Raez2006}.
The firing rate of the \acp{MU} is in the range of $0-20Hz$.

\subsection{\ac{EMG}-based Models}
\label{sec:A-EMGBasedModels}
As previously mentioned, \ac{EMG} measure muscle activation and not muscle forces but there is a correlation between the two.
\ac{EMG}-based models are models developed towards estimating muscle forces and/or joint torques base on \ac{EMG} data \cite{Erdemir2007, Pizzolato2015}.
These models are often based on a modified Hill-type muscle model which describes how the muscle's normalized isometric force  ($F^{norm}_t$) depends on the optimal fibre length ($L^O_m$), tendon slack length ($L^S_T$), and the muscle pennation angle ($\phi (t)$) \cite{Winby2008, Lloyd2003}.
The equation for this type of model, as presented by \textcite{Lloyd2003}, and represented by calculating the \ac{MTU} force ($F^{mt}(t)$) is given by
\begin{align}
\label{eq:hill-equation}
    F^{mt}(t) &= F^{max} \left[ f(l)f(v)a(t) + f_p(l) \right] \cos{\left(\phi (t)\right)} \\ \nonumber
    \phi (t) &= \sin^{-1}\left( \frac{L^O_m\sin{\phi_0}}{L^m(t)}\right)
\end{align}
where $F^{max}$ is the maximum isometric muscle force; $f(v)$ and $f(l)$ the normalized fiber forces dependent on velocity and length respectively; $a(t)$ the time varying muscle activation; $f_p(l)$ the parallel passive elastic force–length; $L^m(t)$ the muscle fiber length at time $t$; and $\phi_0$ the pennation angle at $L^O_m$ \cite{Buchanan2004, Winby2008, Lloyd2003}.
The model geometry of a single \ac{MTU} is represented in figure \ref{fig:MTU-unit}.
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.75\textwidth]{img/MTU-unit}
    \caption{Representation of a \ac{MTU} showing the muscle force $F^m$, tendon force $F^t$, muscle and tendon lengths $L^m$ and $L^t$ respectively, and the pennation angle $\phi$. The figure is adapted and modified from \cite[Fig. 5]{Buchanan2004}}
    \label{fig:MTU-unit}
\end{figure}
The way that these models are base on $EMG$ is that the muscle activation, $a(t)$ in equation \ref{eq:hill-equation}, can be measured with $EMG$.
Other parameters, such as $L^O_m$ and $L^S_T$, are difficult to measure \cite{Winby2008}.
\textcite{Lloyd2003} handle this problem by giving these parameters initial estimations based on previous studies and measurements. The values are then allowed to be adjusted, within a certain limit, to best fit values obtained using an inverse dynamics approach.
Thus, in a way, this \ac{EMG}-based model still uses optimization but it should better reflect on the muscle activation pattern than the previously discussed static and dynamic optimization \cite{Pizzolato2015, Lloyd2003}

As previously stated, \textcite{Pizzolato2015} recognize the drawback of the optimization methods in regards to synergy variation. 
Furthermore, they note that the optimization methods are easily accessible, which is for example reflected by the fact that OpenSim, a tool widely used by researchers, uses those methods in its models \cite{Pizzolato2015, Delp2007, Seth2018}. 
They further state that this accessibility does not apply for EMG-driven methods which "have been developed by different research groups and they are not publicly available, or are limited to isometric tasks" \parencite[1]{Pizzolato2015}.
That motivates their development of \ac{CEINMS}, a tool developed to increase said availability and allows researchers to use \ac{EMG}-driven (or \ac{EMG}-informed) models on collected kinematic, reaction force, and \ac{EMG} data \cite{Pizzolato2015}.

\section{Exoskeletons as Assistive Devices}
\label{sec:A-Exoskeletons}
The exoskeleton, as it will be discussed here, refers to a mobile electromechanical structure which can be worn by a human to provide power amplification, support and/or assistance in human motion (see figure \ref{fig:exoskeleton}). Exoskeletons can also be used for haptic interactions \cite{Anam2012}, but the focus here will be on the groups mentioned before. More specifically, the focus is on exoskeletons as assistive devices for those with physical impairment, i.e. for rehabilitation and/or normal human motion. This excludes exoskeletons as power amplification for professional or military purposes.
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.75\textwidth]{img/exoskeleton}
    \caption{Two different designs of an exoskeleton. The one on the left is the Hyprid Assistive Limb exoskeleton developed by Cyberdyne for the purpose of aiding individuals with disabilities. The one on the right is the Ekso exoskeleton which is mostly used for rehabilitation purposes. The figure is adapted from \cite[Fig. 3]{Young2017}}
    \label{fig:exoskeleton}
\end{figure}

To be able to provide assist to motion the exoskeleton needs a human-exoskeleton interaction together with a control system. 
The control system is how the human motion is translated into mechanical activation, and vice versa. 
\textcite{Anam2012} list four different categorizations of control systems in exoskeletons, namely \textit{Model-based}, \textit{Hierarchy based}, \textit{Physical parameters based}, and \textit{Usage based}. 
For the purpose of this review the focus is set on the first categorization, i.e. \textit{Model-based} control systems.
The article states that the control strategy of an exoskeleton can be divided into two types depending on the model used, namely the \textit{dynamic model} and the \textit{muscle model} based control. 
%One could argue for a third type being a brain model based control like the one implemented in \cite{Wang2017a}, however this type of model will not be discussed further here.

\textcite{Anam2012} divide the \textit{dynamic model} into three different categories, each with its strengths and weaknesses.
These models use systems physical characteristics and motion data to estimate moments and/or forces required from the exoskeleton. 
For example, one of the categories is the artificial intelligent method where one study has used the joint angle, angle velocity, and angle acceleration as input to the model and the joint torque as output, behaving like an inverse dynamics model.
%One might argue that what these models lack in relation to the exoskeleton is responsiveness. 

The \textit{muscle model} uses muscle neural activity and/or joint kinematics to predict muscle forces and resulting joint moments. These models can be split into the two categories: parametric and non-parametric muscle model. 
The difference between them is that in addition to \ac{EMG} data the parametric model needs anthropometric data with information of muscle and joint dynamic \cite{Anam2012}.
This is much like the \ac{EMG}-driven models discussed in the previous chapter \cite{Pizzolato2015}.
The \textit{muscle model} has been researched as a way to provide real-time prediction of muscle forces and joint torques \cite{Pizzolato2015, Anam2012, durandau}. 
Furthermore, as mentioned by \textcite{Anam2012}, much effort has been made towards predicting the user's intentions beforehand by using \ac{EMG} data.
The Hill-type muscle model is possibly the most researched parametric muscle model and some modifications of it have been made throughout the years to make it more accurate \cite{Pizzolato2015, Lloyd2003, Anam2012, Lee14-1}.
For the non-parametric muscle model an artificial neural network could be used \cite{Lee14-1, Kiguchi2012}.  

\section{Artificial neural networks in biomechanics}
The methods to predict joint torque discussed previously all use calculations based on anthropometry and dynamic models of the human body. 
The measured parameters, such as \ac{EMG}, motion, and reaction force data, are used as input into equations based on specific dynamic models of the human body, to estimate the joint torque that best fits the input.
\acp{ANN} on the contrary treats the model part as sort of a \textit{black box} and does not depend on these dynamic models. 
Rather, it simulates the model with a self-organized calculations based on statistical methods.
This means that the \ac{ANN} goes from an input to desired output without direct relations to dynamic models of the human body.
This is important when looking at going from an \ac{EMG} signal to joint torque prediction since the projection of \ac{EMG} to muscle force and joint torque is not well established through dynamic models.
Motion data and reaction forces are needed to get joint torque from dynamic models, and this is not easy to measure in an exoskeleton.

%The \ac{ANN} model has many different design methods (e.g. topology, learning rate, number of epochs) that can be chosen to give the same results as the dynamic models of the human body. 
%However, as previously mentioned, the models (i.e. the \ac{ANN} and the human body models) do not relate kinetically or biologically.
%The aim of the \ac{ANN} model is simply to find the best fit based statistical methods and probability.

\subsection{Machine Learning}
Machine learning refers to a computer algorithm with the ability to learn from data \cite{Goodfellow2016}. \citeauthor{Mitchell1997} gives the following definition of that learning: "A computer program is said to learn from experience $E$ with respect to some class of tasks $T$ and performance measure $P$, if its performance at tasks in $T$, as measured by $P$, improves with experience $E$" \parencite[2]{Mitchell1997}.

Machine learning algorithms contains subcategories of different algorithms within which \acp{ANN}, which this chapter will focus on, is only one of many.
In addition, \ac{ANN} contains even more subcategories depending on number of design factors such as topology.

Most machine learning algorithms, including \acp{ANN}, can be categorized into two groups depending on the manner of learning.
These categories are \textit{supervised learning} and \textit{unsupervised learning} \cite{Goodfellow2016}.
This categorization is visually presented in figure \ref{fig:types-of-learning}.
The focus of this chapter will be on \acp{ANN} using \textit{supervised learning} or more specifically \textit{corrective learning}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.9\textwidth]{img/types-of-learning-diagram.pdf}
    \caption{The tree shows how machine learning algorithms can be categorized by different types of learning. The diagram is based on \cite[Fig. 4.3]{Rojas1996a}}
    \label{fig:types-of-learning}
\end{figure}

\textit{Supervised learning} differs from \textit{unsupervised learning} in that the training data (i.e. the aforementioned "experience") is paired with associated \textit{label} or \textit{target}.
The "performance measure" is then how accurately the algorithm can map a data set (or \textit{features}), $\mathbf{x}$, to the associated target, $y$ \cite{Goodfellow2016}.
How the accuracy is measured and how that measure is used to "teach" the algorithm varies between the different designs of algorithms.
To summarize, supervised learning algorithms typically aim at estimating the probability distribution $p(y | \mathbf{x})$ \cite{Goodfellow2016}.

The "classes of tasks", mentioned in the definition referenced above, contains many different types \cite{Goodfellow2016}.
However, the focus here will be on two, arguably most researched tasks within \textit{supervised learning}, namely \textit{Classification} and \textit{Regression}.

All these concepts of machine learning apply to the subcategory of \acp{ANN} as well, which will be discussed in the next section.

%Curse of dimensionality: "one challenge posed by the curse of dimensionality is a statistical challenge which arises because the number of possible configurations of $x$ is much larger than the number of training examples" \parencite[153]{Goodfellow2016}.

%Capacity: Representational capacity is what "specifies which family of functions the learning algorithm can choose from". Effective capacity refers to the fact that the "best" function within the family is rarely found and thus the actual capacity may be less than the representational capacity \parencite[111]{Goodfellow2016}.

%"The answer to both of these questions—whether it is possible to represent a complicated function efficiently, and whether it is possible for the estimated function to generalize well to new inputs—is yes. The key insight is that a very large number of regions, such as O(2k ), can be defined withO(k) examples, so long as we introduce some dependencies between the regions through additional assumptions about the underlying data-generating distribution. In this way, we can actually generalize nonlocally (Bengio and Monperrus, 2005; Bengio et al., 2006c). Many different deep learning algorithms provide implicit or explicit assumptions that are reasonable for a broad range of AI tasks in order to capture these advantages." \parencite[156]{Goodfellow2016}
One of the most important challenge and goal of machine learning is generalization, i.e. that the trained algorithm works equally well on data it has not been presented with before. 
This highly relates to the concepts of overfitting and underfitting, as defined by \textcite{Goodfellow2016} and represented in figure \ref{fig:over-vs-under}: "Underﬁtting occurs when the model is not able to obtain a suﬃciently low error value on the training set. Overﬁtting occurs when the gap between the training error and test error is too large" \parencite[109]{Goodfellow2016}.
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.9\textwidth]{img/overfitting-vs-underfitting}
    \caption{Algorithm results for machine learning regression of a quadratic function. The blue dots are training samples, the red dot is a testing sample, and the blue line is the algorithms result. On the left there is a high error on the training set, and even though the test set is accurately predicted it is not reliable as there is underfitting. On the right there is clearly a huge error on the test set even though the training set is accurately predicted by the algorithm. Figure is adapted and modified from \cite[Fig. 5.2]{Goodfellow2016}}
    \label{fig:over-vs-under}
\end{figure}

\subsection{Neural Networks}
Like the name suggests \acp{ANN} consist of multiple "artificial neurons", often called nodes, that are interconnected by pathways for communication.
\textit{Topology} refers to how these nodes are placed (e.g. into layers), how many there are, and how they are connected.
Figure \ref{fig:generic-ann} shows an example of a generic multilayer feed-forward \ac{ANN}, also known as \ac{DNN} or \ac{MLP}.
It is feed-forward since it does not contain any feed-back loops, as opposed to \acp{RNN} \cite{Goodfellow2016, Haykin2009}. Furthermore, it is multilayer as it contains, apart from the input and output layer, some hidden layers.

\begin{figure}[ht]
    \centering
    \includegraphics{img/generic-ann-diagram}
    \caption{Generic feed-forward neural network: Layers are (from left to right): an input layer (filled black nodes), two hidden layers, and an output layer. The arrows and the turquoise filled nodes together form a function $f$ which maps the input to the output: $f(\mathbf{x})=\mathbf{y} $.}
    \label{fig:generic-ann}
\end{figure}

\begin{figure}[ht!]
    \centering
    \includegraphics[width=0.6\textwidth]{img/node-diagram}
    \caption{Single node diagram: Shows the inputs $\mathbf{x}$ into a single node of a \ac{NN} and the nodes functionality and process to get an output $\mathbf{y}$. The colored items can all be considered to be part of the node as represented in figure \ref{fig:generic-ann}. The circle denotes the summation of inputs and the square denotes the activation of the node. The figure is based on \cite[Fig. 5]{Haykin2009}.}
    \label{fig:node-diagram}
\end{figure}

Figure \ref{fig:node-diagram} shows a better visualization of what happens at each node of the network.
Each arrow of the feed-forward network is associated with a weight, often denoted with $w$, and each node has a summation characteristic and an \textit{activation function} which determines if (or how much) the node activates.
The node diagram can be represented mathematically with the following two equations:
\begin{align}
    v_k &= \sum_{j=1}^m w_{kj}x_j + b_k \\
    y_k &= \phi (v_k)
\end{align}

Relating figure \ref{fig:generic-ann} to previously defined learning, the \textit{task} might be classification where each $y$ represents a class.
The \textit{experience} is the $n$ dimensional training data set which is fed into the input layer of the network, as the vector $\mathbf{x}$.
The information then propagates through the network, layer by layer, to the output layer. A process called \textit{forward-propagation} \cite{Goodfellow2016}.
The \textit{performance measure} is then how close the output $\mathbf{y}$ is to the target $t$.
If the output is not "close enough" to the target then the mapping function $f$, represented by the arrows and nodes, needs to be updated.
As previously mentioned and shown in figure \ref{fig:node-diagram}, each arrow has an associated weight and these weights are what can be updated to affect $f$.
The update is then typically to minimize a certain cost-function representing the error between the output and the target (e.g. $(y-t)^2$).
This is done through a process called \textit{back-propagation} or \textit{backprop} for short.

Backprop, in short, is about computing the gradient of $f$ from node to node using the chain rule for derivatives. 
The weights are then typically updated to minimize the cost function using gradient descent.
To enable this method the activation function has to be differentiable, i.e. it can not be the step function for example.
Popular activation functions include, for example the sigmoid or the hyperbolic tangent function and the ReLu or softplus function \cite{Goodfellow2016, Haykin2009, Rojas1996}.

Although this brief introduction of neural networks and how they learn has been focused around the feed-forward network, much of the same or similar principles apply to other networks. 
They are, to quote \citeauthor{Goodfellow2016}, "the quintessential deep learning models" \parencite[164]{Goodfellow2016}.



%"It is best to think of feedforward networks as function approximation machines that are designed to achieve statistical generalization" \parencite[165]{Goodfellow2016}.

\subsection{Neural Networks for Biomechanics}
The use of neural networks to predict joint dynamics is nothing new.
\textcite{Sepulveda1993} constructed a \ac{MLP} with a single hidden layer to predict joint angles and joint moments based on EMG signals, more than 20 years ago. 
The training of this relatively small network took a very long time.
Furthermore, the results of the trained algorithm indicate overfitting.
Since then, extended processing power of modern computers has enabled use of more complicated and deeper networks.
Furthermore, extended research into machine learning in recent years has created a lot of recommendations and best practices to aid in development of the best algorithm and improved generalization.

With the current immense popularity with neural networks, many researches have provided alternative algorithms to solve the task of joint torque prediction.
\textcite{Ardestani2014} provide a multi-dimensional wavelet neural network to estimate lower extremity joint moments. 
The input to the network is \ac{EMG} and \ac{GRF} data collected during gait trials of four patients with different conditions. 
\textcite{Lee14-1} use a NNARX (Neural Network, AutoRegressive, eXternal Input) model to estimate knee joint moment in sit-to-stand movement. 
The input was \ac{EMG}, joint angle, and joint velocity as well as previously predicted joint moment. 
\textcite{Kiguchi2012} present a neuro-fuzzy system to estimate joint torques in the upper-limb to use with a power-assist exoskeleton. 
The input to the neuro-fuzzy system is the joint angles and the output are weights to be multiplied by measured \ac{EMG} RMS values.
\textcite{Cui2016} use a NARX-type dynamic \ac{RNN} to estimate lower extremity joint angles during cycling. 
The input is \ac{EMG} signal and feedback from previous prediction.

The challenges related to using \ac{EMG} signal is its redundancy, nonlinear characteristics, and variability between tasks, subjects, conditions (e.g. pathologies, muscle fatigue), etc.
There are many muscles that contribute to the joint torque and with the nonlinear characteristics a higher dimensional data is needed to be able to map the relationship.
However, with higher dimension and the redundancy of the \ac{EMG} signal, there is a risk of overfitting.
Furthermore, due to the variability it is difficult to get a solution that is generalizable.
When working with \ac{EMG} data from many muscles it is useful to preprocess the data with dimensionality reduction and feature extraction and selection. This can contribute to learning efficiency and improve generalization \cite{Chen2018, Marsland2014}.

\end{document}